---
- name: Get server status and dnf-automatic details
  hosts: all
  gather_facts: yes

  tasks:
  - name: Gather package facts
    ansible.builtin.package_facts:
      manager: auto

  - name: Gather service facts
    ansible.builtin.service_facts:

  - name: Display server status and dnf-automatic info
    ansible.builtin.debug:
      msg: |
        Server Status for {{ ansible_hostname }}:
        -------------------------------------
        - Operating System: {{ ansible_distribution }} {{ ansible_distribution_version }}

        - DNF Automatic Service:
          {% if 'dnf-automatic' in ansible_facts.packages %}
          Status: Installed ✅
          Running: {{ 'Yes' if ansible_facts.services['dnf-automatic.timer'].state == 'running' else 'No' }}
          {% else %}
          Status: Not Installed ❌
          {% endif %}
